<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head th:include="bootstrap :: head (page_title='Token Admin Page')">
<meta charset="UTF-8" />
<title>Insert title here</title>
</head>
<body>

<div class="container">
	<div class="col-xs-12">

		<h1>Clients - Tokens List</h1>
		<hr/>
		
		<div class="alert alert-success" th:if="${param['revoke-success']}">
			好嘞，Token被revoke了。
			<button type="button" class="close" data-dismiss="alert" aria-label="Close">
			  <span aria-hidden="true">&times;</span>
			</button>
		</div>
		
		<div class="alert alert-warning" th:if="${param['revoke-empty']}">
			饿，没有Token被revoke。
			<button type="button" class="close" data-dismiss="alert" aria-label="Close">
			  <span aria-hidden="true">&times;</span>
			</button>
		</div>

		<table class="table table-hover table-condensed table-hover" th:each="client : ${tokensList}">
			<caption th:inline="text">Tokens for client: [[ ${ client.key } ]]</caption>
			<thead>
				<tr>
					<th>#</th>
					<th>User</th>
					<th>Token</th>
					<th>Type</th>
					<th>Is Expired</th>
					<th>Expiration</th>
					<th>Expires In</th>
					<th>Scopes</th>
					<th>refreshToken</th>
					<th>Action</th>
				</tr>
			</thead>
			<tbody>
				<tr th:each="token, iterStat : ${client.value} ">
					<td th:text="${iterStat.count}">#</td>
					<td th:text="${token.additionalInformation.user_name}">User</td>
					<td th:text="${token.value}">Token</td>
					<td th:text="${token.tokenType}">Type</td>
					<td th:text="${token.expired}">isExpired</td>
					<td th:text="${token.expiration}">expiration</td>
					<td th:text="${token.expiresIn}">Expires In</td>
					<td th:text="${token.scope}">Scopes</td>
					<td th:text="${token.refreshToken}">refreshToken</td>
					<td>
						<form th:action="@{/oauth/tokens/revoke}" method="post">
							<input type="hidden" name="user" th:value="${token.additionalInformation.user_name}" />
							<input type="hidden" name="token" th:value="${token.value}" />
							<button type="submit" class="btn btn-danger">Revoke</button>
						</form>
					</td>
				</tr>
			</tbody>
		</table>
		
	</div>
</div>
</body>
</html>