<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head th:include="bootstrap :: head (page_title='客户端管理页面')">
</head>
<body>
<div class="container">
    <div class="col-lg-12" th:include="messages :: messages"></div>
    <div class="col-lg-12">
        <a href="#" th:href="@{/}" class="btn btn-primary">返回首页</a>
    </div>
    <div class="col-lg-12">
        <h1>客户端管理页面</h1>
        <hr/>
        <nav aria-label="Page navigation" th:include="bootstrap :: page-navigation (pageable=${clientDetailsList})"></nav>
        <table class="table table-hover table-condensed">
            <caption>客户端</caption>
            <thead>
            <tr>
                <th>#</th>
                <th>客户端ID</th>
                <th>AccessToken<br/>有效秒数</th>
                <th>RefreshToken<br/>有效秒数</th>
                <th>授权方式</th>
                <th>授权范围</th>
                <th>可用资源ID</th>
                <th>已注册<br/>跳转URI</th>
                <th>操作</th>
            </tr>
            </thead>
            <tbody>
            <th:block th:each="clientDetails, iterStat : ${clientDetailsList}">
            <tr>
                <td th:text="${clientDetails.id}" rowspan="2">#</td>
                <td th:text="${clientDetails.clientId}" rowspan="2">客户端ID</td>
                <td th:text="${clientDetails.accessTokenValiditySeconds}">AccessToken<br/>有效秒数</td>
                <td th:text="${clientDetails.refreshTokenValiditySeconds}">RefreshToken<br/>有效秒数</td>
                <td>
                    <span class="label label-primary" th:each="xref : ${clientDetails.authorizedGrantTypeXrefs}" th:text="${xref.grantType.value}">授权方式</span>
                </td>
                <td>
                    <span class="label label-info" th:each="xref : ${clientDetails.scopeXrefs}" th:inline="text">[[${xref.scope.value}]]&nbsp;<span class="glyphicon glyphicon-ok" th:if="${xref.autoApprove}" data-toggle="tooltip" title="自动授权"></span></span>
                </td>
                <td>
                    <button type="button" class="btn btn-default" data-toggle="collapse"
                            th:attr="data-target=|#resource-id-${clientDetails.id}|,aria-controls=|resource-id-${clientDetails.id}|" aria-expanded="false" >点击查看</button>
                </td>
                <td>
                    <button type="button" class="btn btn-default" data-toggle="collapse"
                            th:attr="data-target=|#redirect-uri-${clientDetails.id}|,aria-controls=|redirect-uri-${clientDetails.id}|" aria-expanded="false" >点击查看</button>
                </td>
                <td><a sec:authorize="hasRole('ROLE_ADMIN')" class="btn btn-danger" href="#" th:href="@{|/clientDetails/_remove/${clientDetails.clientId}|}" role="button">删除</a></td>
            </tr>
            <tr>
                <td colspan="7">
                    <div class="collapse" th:attr="id=|resource-id-${clientDetails.id}|">
                        <h6>可用资源ID</h6>
                        <span class="label label-success" th:each="xref : ${clientDetails.resourceIdXrefs}" th:text="${xref.resourceId.value}">可用资源ID</span>
                    </div>
                    <hr/>
                    <div class="collapse" th:attr="id=|redirect-uri-${clientDetails.id}|">
                        <h6>已注册跳转URI</h6>
                    <ul>
                        <li th:each="urlXref, urlXrefIterStat : ${clientDetails.redirectUris}" th:text="${urlXref.value}">url</li>
                    </ul>
                    </div>
                </td>
            </tr>
            </th:block>
            </tbody>
        </table>
        <nav aria-label="Page navigation" th:include="bootstrap :: page-navigation (pageable=${clientDetailsList})"></nav>
    </div>
    <div class="col-lg-12">
        <h1>增加客户端</h1>
        <hr/>
        <form action="#" th:action="@{/clientDetails/_create}" method="post">
            <div class="form-group col-lg-4">
                <label for="clientId">客户端ID</label>
                <input type="text" class="form-control" id="clientId" name="clientId" placeholder="客户端ID" required="required" th:value="${clientId}" />
            </div>
            <div class="form-group col-lg-4">
                <label for="clientSecret">客户端密码</label>
                <input type="text" class="form-control" id="clientSecret" name="clientSecret" placeholder="客户端密码" required="required" />
            </div>
            <div class="form-group col-lg-2">
                <label for="accessTokenValiditySeconds">AccessToken有效秒数</label>
                <input type="number" class="form-control" id="accessTokenValiditySeconds" name="accessTokenValiditySeconds" placeholder="AccessToken有效秒数" th:value="${accessTokenValiditySeconds}" />
            </div>
            <div class="form-group col-lg-2">
                <label for="refreshTokenValiditySeconds">RefreshToken有效秒数</label>
                <input type="number" class="form-control" id="refreshTokenValiditySeconds" name="refreshTokenValiditySeconds" placeholder="RefreshToken有效秒数" th:value="${refreshTokenValiditySeconds}" />
            </div>
            <div class="form-group col-lg-12">
                <label>授权方式</label>
                <div class="checkbox">
                    <label th:each="grantType : ${grantTypes}">
                        <input type="checkbox" name="grantTypes" value="grantType" th:value="${grantType.value}" th:checked="${#lists.contains(#objects.nullSafe(selectedGrantTypes, {}), grantType.value)}" />
                        <span class="label label-primary" th:text="${grantType.value}">授权方式</span>
                    </label>
                </div>
            </div>
            <div class="form-group col-lg-12">
                <label>授权范围</label>
                <div class="checkbox">
                    <label th:each="scope : ${scopes}">
                        <input type="checkbox" name="scopes" value="scope" th:value="${scope.value}" th:checked="${#lists.contains(#objects.nullSafe(selectedScopes, {}), scope.value)}" />
                        <span class="label label-info" th:text="${scope.value}">授权范围</span>
                    </label>
                </div>
            </div>
            <div class="form-group col-lg-12">
                <label>自动授权范围</label>
                <div class="checkbox">
                    <label>
                        <input type="checkbox" name="autoApproveAll" value="true" th:checked="${autoApproveAll}" />
                        <span class="label label-danger">全范围自动授权</span>
                    </label>
                </div>
                <div class="checkbox">
                    <label th:each="scope : ${scopes}">
                        <input type="checkbox" name="autoApproveScopes" value="scope" th:value="${scope.value}" th:checked="${#lists.contains(#objects.nullSafe(selectedAutoApproveScopes, {}), scope.value)}" />
                        <span class="label label-info" th:text="${scope.value}">授权范围</span>
                    </label>
                </div>
            </div>
            <div class="form-group col-lg-12">
                <label>可用资源ID</label>
                <div class="checkbox">
                    <label th:each="resourceId : ${resourceIds}">
                        <input type="checkbox" name="resourceIds" value="resourceId" th:value="${resourceId.value}" th:checked="${#lists.contains(#objects.nullSafe(selectedResourceIds, {}), resourceId.value)}" />
                        <span class="label label-success" th:text="${resourceId.value}">可用资源ID</span>
                    </label>
                </div>
            </div>
            <div class="form-group col-lg-12">
                <label for="redirectUris">注册跳转URI</label>
                <textarea class="form-control" id="redirectUris" rows="3" name="redirectUris" th:text="${redirectUris}"></textarea>
                <span class="help-block">一行一个URI</span>
            </div>
            <div class="form-group col-lg-12">
                <div class="pull-right">
                    <button type="submit" class="btn btn-primary">提交</button>
                    <a type="button" class="btn btn-default" href="#" th:href="@{/clientDetails}">取消</a>
                </div>
            </div>
        </form>
    </div>
</div>
<script type="text/javascript" th:inline="javascript">
/*<![CDATA[*/
    $(function () {
        $('[data-toggle="tooltip"]').tooltip();
    })
/*]]>*/
</script>
</body>
</html>